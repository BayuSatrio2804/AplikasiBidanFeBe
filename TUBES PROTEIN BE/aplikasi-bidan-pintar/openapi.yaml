openapi: 3.0.3
info:
  title: Aplikasi Bidan Pintar API
  description: |
    Backend API for **Aplikasi Bidan Pintar** (Smart Midwife Application), 
    a healthcare management system for midwifery clinics.
    
    ## Key Features
    - JWT-based authentication with OTP verification
    - Patient record management
    - Appointment scheduling
    - Medical examination (SOAP format)
    - Specialized service registration (ANC, KB, Immunization, Delivery)
    - Dashboard analytics and reporting
    
    ## Authentication Flow
    1. User logs in with credentials → OTP sent to email
    2. User verifies OTP → JWT token issued
    3. Use JWT token for all subsequent requests
  version: 1.0.0
  contact:
    name: API Support
  license:
    name: MIT

servers:
  - url: http://localhost:5000/api
    description: Development server
  - url: http://localhost:5000/v1
    description: Versioned API

tags:
  - name: Authentication
    description: User authentication and profile management
  - name: Patients
    description: Patient record management
  - name: Schedules
    description: Appointment scheduling
  - name: Examinations
    description: Medical examination (SOAP format)
  - name: Dashboard
    description: Analytics and statistics
  - name: Reports
    description: Report generation
  - name: KB
    description: Family Planning (Keluarga Berencana) services
  - name: ANC
    description: Antenatal Care services
  - name: Immunization
    description: Immunization services
  - name: Delivery
    description: Delivery/Birth services
  - name: Patient Visit
    description: General patient visit services

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT token obtained after OTP verification

  schemas:
    # Common Response Schemas
    SuccessResponse:
      type: object
      properties:
        success:
          type: boolean
          example: true
        message:
          type: string
        data:
          type: object

    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
        errors:
          type: array
          items:
            type: object
            properties:
              field:
                type: string
              message:
                type: string

    # User Schema
    User:
      type: object
      properties:
        id_user:
          type: string
          format: uuid
        nama_lengkap:
          type: string
        username:
          type: string
        email:
          type: string
          format: email

    # Patient Schema
    Patient:
      type: object
      properties:
        id_pasien:
          type: string
          format: uuid
        nama:
          type: string
        nik:
          type: string
          pattern: '^\d{16}$'
        umur:
          type: integer
          minimum: 1
        alamat:
          type: string
        no_hp:
          type: string
          minLength: 8
          maxLength: 15

    PatientInput:
      type: object
      required:
        - nama
        - NIK
        - umur
        - alamat
        - no_hp
      properties:
        nama:
          type: string
        NIK:
          type: string
          pattern: '^\d{16}$'
          description: Exactly 16 digits
        umur:
          type: integer
          minimum: 1
        alamat:
          type: string
        no_hp:
          type: string
          minLength: 8
          maxLength: 15

    # Schedule Schema
    Schedule:
      type: object
      properties:
        id_jadwal:
          type: string
          format: uuid
        tanggal:
          type: string
          format: date
        jam_mulai:
          type: string
          pattern: '^\d{2}:\d{2}:\d{2}$'
        jam_selesai:
          type: string
          pattern: '^\d{2}:\d{2}:\d{2}$'
        jenis_layanan:
          $ref: '#/components/schemas/JenisLayanan'
        nama_pasien:
          type: string
        nama_petugas:
          type: string

    ScheduleInput:
      type: object
      required:
        - id_pasien
        - id_petugas
        - jenis_layanan
        - tanggal
        - jam_mulai
      properties:
        id_pasien:
          type: string
          format: uuid
        id_petugas:
          type: string
          format: uuid
        jenis_layanan:
          $ref: '#/components/schemas/JenisLayanan'
        tanggal:
          type: string
          format: date
        jam_mulai:
          type: string
          pattern: '^\d{2}:\d{2}:\d{2}$'
        jam_selesai:
          type: string
          pattern: '^\d{2}:\d{2}:\d{2}$'

    # Examination Schema
    Examination:
      type: object
      properties:
        id_pemeriksaan:
          type: string
          format: uuid
        id_pasien:
          type: string
          format: uuid
        jenis_layanan:
          $ref: '#/components/schemas/JenisLayanan'
        subjektif:
          type: string
          description: Patient complaints/symptoms (S)
        objektif:
          type: string
          description: Physical examination findings (O)
        analisa:
          type: string
          description: Diagnosis/assessment (A)
        tatalaksana:
          type: string
          description: Treatment plan (P)
        tanggal_pemeriksaan:
          type: string
          format: date-time

    ExaminationInput:
      type: object
      required:
        - id_pasien
        - jenis_layanan
        - subjektif
        - objektif
        - analisa
        - tatalaksana
      properties:
        id_pasien:
          type: string
          format: uuid
        jenis_layanan:
          $ref: '#/components/schemas/JenisLayanan'
        subjektif:
          type: string
        objektif:
          type: string
        analisa:
          type: string
        tatalaksana:
          type: string
        tanggal_pemeriksaan:
          type: string
          format: date-time

    # Enums
    JenisLayanan:
      type: string
      enum:
        - ANC
        - KB
        - Imunisasi
        - Persalinan
        - Kunjungan Pasien

    MetodeKB:
      type: string
      enum:
        - KDM
        - PIL
        - SUNTIK
        - IMP
        - IUD
        - LAINNYA
      description: |
        - KDM: Kalender/Metode Alamiah
        - PIL: Pil KB
        - SUNTIK: Suntik KB
        - IMP: Implan
        - IUD: IUD (Spiral)
        - LAINNYA: Metode Lainnya

    JenisKelamin:
      type: string
      enum:
        - L
        - P
        - Tidak Diketahui
      description: |
        - L: Laki-laki (Male)
        - P: Perempuan (Female)
        - Tidak Diketahui: Unknown

    JenisKunjungan:
      type: string
      enum:
        - Bayi/Anak
        - Umum
        - Lain-lain

    # KB Schema
    KBInput:
      type: object
      required:
        - jenis_layanan
        - tanggal
        - metode
        - nama_istri
        - nik_istri
        - umur_istri
        - td_ibu
        - bb_ibu
        - alamat
        - no_hp
        - nama_suami
      properties:
        jenis_layanan:
          type: string
          enum: [KB]
        tanggal:
          type: string
          format: date
        metode:
          $ref: '#/components/schemas/MetodeKB'
        no_reg_lama:
          type: string
        no_reg_baru:
          type: string
        kunjungan_ulang:
          type: string
          format: date
        nama_istri:
          type: string
        nik_istri:
          type: string
          pattern: '^\d{16}$'
        umur_istri:
          type: integer
          minimum: 1
        td_ibu:
          type: string
          description: Blood pressure
        bb_ibu:
          type: number
          minimum: 1
          description: Body weight
        alamat:
          type: string
        no_hp:
          type: string
          minLength: 8
          maxLength: 15
        nama_suami:
          type: string
        nik_suami:
          type: string
          pattern: '^\d{16}$'
        umur_suami:
          type: integer
        td_ayah:
          type: string
        bb_ayah:
          type: number
        catatan:
          type: string
        subjektif:
          type: string
        objektif:
          type: string
        analisa:
          type: string
        tatalaksana:
          type: string

    # ANC Schema
    ANCInput:
      type: object
      required:
        - jenis_layanan
        - tanggal
        - nama_istri
        - nik_istri
        - umur_istri
        - alamat
        - no_hp
        - nama_suami
        - hasil_pemeriksaan
      properties:
        jenis_layanan:
          type: string
          enum: [ANC]
        tanggal:
          type: string
          format: date
        tindakan:
          type: string
        no_reg_lama:
          type: string
        no_reg_baru:
          type: string
        nama_istri:
          type: string
        nik_istri:
          type: string
          pattern: '^\d{16}$'
        umur_istri:
          type: integer
          minimum: 1
        alamat:
          type: string
        no_hp:
          type: string
          minLength: 8
          maxLength: 15
        nama_suami:
          type: string
        nik_suami:
          type: string
          pattern: '^\d{16}$'
        umur_suami:
          type: integer
        hpht:
          type: string
          format: date
          description: Last menstrual period
        hpl:
          type: string
          format: date
          description: Estimated due date
        hasil_pemeriksaan:
          type: string
        keterangan:
          type: string
        subjektif:
          type: string
        objektif:
          type: string
        analisa:
          type: string
        tatalaksana:
          type: string

    # Immunization Schema
    ImunisasiInput:
      type: object
      required:
        - jenis_layanan
        - tanggal
        - jenis_imunisasi
        - nama_istri
        - nik_istri
        - umur_istri
        - alamat
        - nama_suami
        - nama_bayi_balita
        - tanggal_lahir_bayi
        - tb_bayi
        - bb_bayi
        - jadwal_selanjutnya
        - no_hp
      properties:
        jenis_layanan:
          type: string
          enum: [Imunisasi]
        tanggal:
          type: string
          format: date
        no_reg:
          type: string
        jenis_imunisasi:
          type: string
          description: Vaccine type
        nama_istri:
          type: string
        nik_istri:
          type: string
          pattern: '^\d{16}$'
        umur_istri:
          type: integer
          minimum: 1
        alamat:
          type: string
        nama_suami:
          type: string
        nik_suami:
          type: string
          pattern: '^\d{16}$'
        umur_suami:
          type: integer
        nama_bayi_balita:
          type: string
        tanggal_lahir_bayi:
          type: string
          format: date
        tb_bayi:
          type: number
          minimum: 1
          description: Height in cm
        bb_bayi:
          type: number
          minimum: 1
          description: Weight in kg
        jadwal_selanjutnya:
          type: string
          format: date
        no_hp:
          type: string
          minLength: 8
          maxLength: 15
        pengobatan:
          type: string
        subjektif:
          type: string
        objektif:
          type: string
        analisa:
          type: string
        tatalaksana:
          type: string

    # Persalinan Schema
    PersalinanInput:
      type: object
      required:
        - jenis_layanan
        - tanggal
        - penolong
        - nama_istri
        - nik_istri
        - umur_istri
        - alamat
        - no_hp
        - td_ibu
        - bb_ibu
        - nama_suami
        - tanggal_lahir
        - jenis_kelamin
        - anak_ke
        - jenis_partus
        - imd_dilakukan
        - bb_bayi
        - pb_bayi
        - lika_bayi
        - lila_ibu
        - lida_ibu
      properties:
        jenis_layanan:
          type: string
          enum: [Persalinan]
        tanggal:
          type: string
          format: date
        penolong:
          type: string
          description: Birth attendant name
        no_reg_lama:
          type: string
        no_reg_baru:
          type: string
        nama_istri:
          type: string
        nik_istri:
          type: string
          pattern: '^\d{16}$'
        umur_istri:
          type: integer
          minimum: 1
        alamat:
          type: string
        no_hp:
          type: string
          minLength: 8
          maxLength: 15
        td_ibu:
          type: string
          description: Blood pressure
        bb_ibu:
          type: number
          minimum: 1
          description: Body weight
        nama_suami:
          type: string
        nik_suami:
          type: string
          pattern: '^\d{16}$'
        umur_suami:
          type: integer
        tanggal_lahir:
          type: string
          format: date
        jenis_kelamin:
          $ref: '#/components/schemas/JenisKelamin'
        anak_ke:
          type: integer
          minimum: 1
        jenis_partus:
          type: string
          description: Delivery type
        imd_dilakukan:
          type: boolean
          description: Early breastfeeding initiation
        as_bayi:
          type: string
          description: APGAR score
        bb_bayi:
          type: number
          minimum: 1
          description: Baby weight in grams
        pb_bayi:
          type: number
          minimum: 1
          description: Baby length in cm
        lika_bayi:
          type: number
          minimum: 1
          description: Baby head circumference
        lila_ibu:
          type: number
          minimum: 1
          description: Upper arm circumference
        lida_ibu:
          type: number
          minimum: 1
          description: Chest circumference
        subjektif:
          type: string
        objektif:
          type: string
        analisa:
          type: string
        tatalaksana:
          type: string

    # Kunjungan Pasien Schema
    KunjunganPasienInput:
      type: object
      required:
        - jenis_layanan
        - tanggal
        - jenis_kunjungan
        - nama_pasien
        - nik_pasien
        - umur_pasien
        - nama_wali
        - keluhan
        - diagnosa
      properties:
        jenis_layanan:
          type: string
          enum: [Kunjungan Pasien]
        tanggal:
          type: string
          format: date
        no_reg:
          type: string
        jenis_kunjungan:
          $ref: '#/components/schemas/JenisKunjungan'
        nama_pasien:
          type: string
          description: Actual patient name
        nik_pasien:
          type: string
          pattern: '^\d{16}$'
        umur_pasien:
          type: string
          description: Age (e.g., '6 bln' or '2 thn')
        bb_pasien:
          type: number
          minimum: 0
          description: Patient weight
        td_pasien:
          type: string
          description: Blood pressure
        nama_wali:
          type: string
          description: Parent/guardian name
        nik_wali:
          type: string
          pattern: '^\d{16}$'
        umur_wali:
          type: integer
        keluhan:
          type: string
          description: Chief complaint
        diagnosa:
          type: string
          description: Diagnosis
        terapi_obat:
          type: string
          description: Medication therapy
        keterangan:
          type: string
          description: Notes
        subjektif:
          type: string
        objektif:
          type: string
        analisa:
          type: string
        tatalaksana:
          type: string

    # Dashboard Schema
    RekapLayanan:
      type: object
      properties:
        total:
          type: integer
        data:
          type: array
          items:
            type: object
            properties:
              layanan:
                type: string
              jumlah_pasien:
                type: integer
              persentase:
                type: number

paths:
  # Health Check
  /health:
    get:
      summary: Health Check
      description: Check if the server is running
      tags:
        - Health
      responses:
        '200':
          description: Server is healthy
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: ok
                  timestamp:
                    type: string
                    format: date-time

  # Authentication Endpoints
  /auth/register:
    post:
      summary: Register User
      description: Register a new user account
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - nama_lengkap
                - username
                - email
                - password
              properties:
                nama_lengkap:
                  type: string
                username:
                  type: string
                  minLength: 3
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 6
      responses:
        '201':
          description: Registration successful
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        '400':
          description: Validation error or duplicate user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /auth/login:
    post:
      summary: Login
      description: Authenticate user and trigger OTP verification
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - usernameOrEmail
                - password
              properties:
                usernameOrEmail:
                  type: string
                  description: Username or Email
                password:
                  type: string
      responses:
        '200':
          description: OTP sent to email
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Password benar. Kode OTP telah dikirim ke email Anda.
                  data:
                    type: object
                    properties:
                      email:
                        type: string
                        format: email
        '401':
          description: Invalid password
        '404':
          description: User not found

  /auth/verify-otp:
    post:
      summary: Verify OTP
      description: Verify OTP code and receive JWT token
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - usernameOrEmail
                - otp_code
              properties:
                usernameOrEmail:
                  type: string
                otp_code:
                  type: string
                  pattern: '^\d{6}$'
                  description: Exactly 6 digits
      responses:
        '200':
          description: Verification successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      token:
                        type: string
                      user:
                        $ref: '#/components/schemas/User'
        '400':
          description: Invalid or expired OTP

  /auth/resend-otp:
    post:
      summary: Resend OTP
      description: Request a new OTP code
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - usernameOrEmail
              properties:
                usernameOrEmail:
                  type: string
      responses:
        '200':
          description: New OTP sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /auth/forgot-password/request:
    post:
      summary: Request Password Reset
      description: Request password reset OTP
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
              properties:
                email:
                  type: string
                  format: email
      responses:
        '200':
          description: Reset code sent
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /auth/forgot-password/verify-code:
    post:
      summary: Verify Reset Code
      description: Verify reset OTP and get reset token
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - otp_code
              properties:
                email:
                  type: string
                  format: email
                otp_code:
                  type: string
                  pattern: '^\d{6}$'
      responses:
        '200':
          description: Code verified
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  data:
                    type: object
                    properties:
                      reset_token:
                        type: string
                      id_user:
                        type: string
                        format: uuid

  /auth/forgot-password/reset:
    post:
      summary: Reset Password
      description: Set new password using reset token
      tags:
        - Authentication
      parameters:
        - name: X-Reset-Token
          in: header
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - id_user
                - new_password
              properties:
                id_user:
                  type: string
                  format: uuid
                new_password:
                  type: string
                  minLength: 6
      responses:
        '200':
          description: Password reset successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /auth/me:
    get:
      summary: Get User Profile
      description: Get current authenticated user's profile
      tags:
        - Authentication
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Profile retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'
        '401':
          description: Unauthorized

    put:
      summary: Update User Profile
      description: Update authenticated user's profile
      tags:
        - Authentication
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                nama_lengkap:
                  type: string
                username:
                  type: string
                  minLength: 3
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 6
      responses:
        '200':
          description: Profile updated
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/User'

  # Patient Endpoints
  /pasien:
    get:
      summary: Get All Patients
      description: Get list of all patients with optional search
      tags:
        - Patients
      security:
        - bearerAuth: []
      parameters:
        - name: search
          in: query
          schema:
            type: string
          description: Search by name or NIK
      responses:
        '200':
          description: Patients retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Patient'

    post:
      summary: Create Patient
      description: Create a new patient record
      tags:
        - Patients
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatientInput'
      responses:
        '201':
          description: Patient created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Patient'

  /pasien/{id}:
    get:
      summary: Get Patient by ID
      description: Get single patient by ID
      tags:
        - Patients
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Patient retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Patient'
        '404':
          description: Patient not found

    put:
      summary: Update Patient
      description: Update patient information
      tags:
        - Patients
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatientInput'
      responses:
        '200':
          description: Patient updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

    delete:
      summary: Delete Patient
      description: Delete a patient record
      tags:
        - Patients
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Patient deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  /pasien/{id}/riwayat:
    get:
      summary: Get Patient Medical History
      description: Get patient's medical examination history
      tags:
        - Patients
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: History retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Examination'

  # Schedule Endpoints
  /jadwal:
    get:
      summary: Get All Schedules
      description: Get list of schedules with optional filtering
      tags:
        - Schedules
      security:
        - bearerAuth: []
      parameters:
        - name: bulan
          in: query
          schema:
            type: integer
            minimum: 1
            maximum: 12
          description: Month (1-12)
        - name: tahun
          in: query
          schema:
            type: integer
          description: Year
        - name: layanan
          in: query
          schema:
            type: string
          description: Service type filter
      responses:
        '200':
          description: Schedules retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Schedule'

    post:
      summary: Create Schedule
      description: Create a new appointment schedule
      tags:
        - Schedules
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScheduleInput'
      responses:
        '201':
          description: Schedule created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Schedule'

  /jadwal/{id}:
    get:
      summary: Get Schedule Detail
      description: Get single schedule by ID
      tags:
        - Schedules
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Schedule retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Schedule'

    put:
      summary: Update Schedule
      description: Update schedule information
      tags:
        - Schedules
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ScheduleInput'
      responses:
        '200':
          description: Schedule updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

    delete:
      summary: Delete Schedule
      description: Delete a schedule
      tags:
        - Schedules
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Schedule deleted
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # Examination Endpoints
  /pemeriksaan:
    get:
      summary: Get All Examinations
      description: Get list of all medical examinations
      tags:
        - Examinations
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Examinations retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Examination'

    post:
      summary: Create Examination
      description: Create new medical examination record (SOAP format)
      tags:
        - Examinations
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExaminationInput'
      responses:
        '201':
          description: Examination created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Examination'

  /pemeriksaan/{id}:
    get:
      summary: Get Examination Detail
      description: Get single examination by ID
      tags:
        - Examinations
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Examination retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Examination'

    put:
      summary: Update Examination
      description: Update examination record
      tags:
        - Examinations
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ExaminationInput'
      responses:
        '200':
          description: Examination updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SuccessResponse'

  # Dashboard Endpoints
  /dashboard/rekap-layanan:
    get:
      summary: Get Service Summary
      description: Get summary statistics of all services
      tags:
        - Dashboard
      security:
        - bearerAuth: []
      parameters:
        - name: tahun
          in: query
          schema:
            type: integer
          description: Filter by year
      responses:
        '200':
          description: Summary retrieved
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/RekapLayanan'

  # Reports Endpoints
  /laporan:
    get:
      summary: Generate Monthly Report
      description: Generate and download monthly report in Excel format
      tags:
        - Reports
      security:
        - bearerAuth: []
      parameters:
        - name: format
          in: query
          required: true
          schema:
            type: string
            enum: [excel]
          description: Must be "excel"
        - name: bulan
          in: query
          required: true
          schema:
            type: integer
            minimum: 1
            maximum: 12
          description: Month (1-12)
        - name: tahun
          in: query
          required: true
          schema:
            type: integer
            minimum: 2020
          description: Year (min 2020)
      responses:
        '200':
          description: Excel file generated
          content:
            application/vnd.openxmlformats-officedocument.spreadsheetml.sheet:
              schema:
                type: string
                format: binary
        '400':
          description: Invalid parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  # KB Endpoints
  /kb:
    post:
      summary: Create KB Registration
      description: Register a new family planning service visit
      tags:
        - KB
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KBInput'
      responses:
        '201':
          description: KB registration created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id_kb:
                            type: string
                            format: uuid
                          id_pemeriksaan:
                            type: string
                            format: uuid
                          id_pasien:
                            type: string
                            format: uuid

  # ANC Endpoints
  /anc:
    post:
      summary: Create ANC Registration
      description: Register a new antenatal care visit
      tags:
        - ANC
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ANCInput'
      responses:
        '201':
          description: ANC registration created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id_anc:
                            type: string
                            format: uuid
                          id_pemeriksaan:
                            type: string
                            format: uuid
                          id_pasien:
                            type: string
                            format: uuid

  # Immunization Endpoints
  /imunisasi:
    post:
      summary: Create Immunization Registration
      description: Register a new immunization visit
      tags:
        - Immunization
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImunisasiInput'
      responses:
        '201':
          description: Immunization registration created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id_imunisasi:
                            type: string
                            format: uuid
                          id_pemeriksaan:
                            type: string
                            format: uuid
                          id_pasien:
                            type: string
                            format: uuid

  # Persalinan Endpoints
  /persalinan:
    post:
      summary: Create Delivery Registration
      description: Register a new delivery/birth record
      tags:
        - Delivery
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PersalinanInput'
      responses:
        '201':
          description: Delivery registration created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id_persalinan:
                            type: string
                            format: uuid
                          id_pemeriksaan:
                            type: string
                            format: uuid
                          id_pasien:
                            type: string
                            format: uuid

  # Kunjungan Pasien Endpoints
  /kunjungan-pasien:
    post:
      summary: Create Patient Visit Registration
      description: Register a general patient visit (for baby/child/adult general checkups)
      tags:
        - Patient Visit
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/KunjunganPasienInput'
      responses:
        '201':
          description: Patient visit registration created
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/SuccessResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id_kunjungan:
                            type: string
                            format: uuid
                          id_pemeriksaan:
                            type: string
                            format: uuid
                          id_pasien:
                            type: string
                            format: uuid
